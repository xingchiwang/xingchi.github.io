## 数据仓库
定义：数据仓库，按照传统的定义，数据仓库是一个面向主题的、集成的、非易失的、反映历史变化（随时间变化），用来支持管理人管决策的数据集合。
## OLTP与OLAP对比
![image](https://user-images.githubusercontent.com/44181286/131643758-ecf3eecc-a4ab-4950-ae75-5ff0eb7ddbbf.png)

## 数据分层
数据分层的优点：
1.清晰数据结构
2.减少重复开发
3.统一数据口径
4.复杂问题简单化

![image](https://user-images.githubusercontent.com/44181286/131644123-af0af96a-3904-4130-a7a2-81058852b527.png)

## 维度建模
维度建模的步骤
维度建模一般按照四个步骤：选择业务过程->声明粒度->确认维度->确认事实
1.选择业务过程：在业务系统中，挑选业务线，比如支付业务，一条业务线对应一张事实表。
2.声明粒度：数据粒度指数据仓库的数据中保存数据的细化程度或综合程度的级别。
3.确认维度：维度的主要作用是描述业务的事实，主要表示的是“谁，何处，何时”等信息
4.确认事实：“事实”指的是业务中的度量值，例如订单金额、下单次数等。

### 星型模型
星型模型的维度建模有一个事实表和一组维表组成。
具有以下特点：
1.维表和事实表关联，维表之间没有关联；
2.每个维表的主键为单列，且该主键放置在事实表中，作为两边连接的逻辑外键；
3.以事实表为核心，维表围绕核心呈星型分布；
![image](https://user-images.githubusercontent.com/44181286/131644637-f4767438-ab60-4dda-bb91-80445baa3bff.png)


### 雪花模型
雪花模型是星型模型的扩展，三范式代表作，相当于将星型模型的大维表拆分成小维表，满足了规范化设计。
![image](https://user-images.githubusercontent.com/44181286/131644697-d9c8444f-c2c6-48c0-adfd-8a20c3320d7f.png)


### 维度变化
缓慢变化维：随时间发生变化的维度我们一般称之为缓慢变化维
处理方式：
1.重写维度值(SCD1)：不需要保留此维度属性历史变化的情况。
![image](https://user-images.githubusercontent.com/44181286/131644995-1e467234-2396-4ec1-9e82-7d0a89c6fbd3.png)

2.插入新的维度行(SCD2)：属性改变前的事实表行和旧的纬度值关联，而新的事实表行和新的纬度值关联
![image](https://user-images.githubusercontent.com/44181286/131645081-33c2aeb6-baa0-4805-8180-7d7a686382dc.png)

3.插入新的维度列(SCD3)：某些情况下，用户需要能用变化前的属性值，也能用变化会后的属性值来分析变化前后的所有事实
![image](https://user-images.githubusercontent.com/44181286/131645156-c5fbe7bd-c041-4ef1-8570-58cc944d582e.png)

### 维度层次和一致性
1.维度层次：维度层次是指某个维度表中属性之间存在从属关系（商品类目：一级类目、二级类目、三级类目等）
          商品的一到三级类目分别用三个字段来存储
          新建类目维度表，并在维度表中维护父子关系
2.维度一致性：维度一致性是指如果两个维度有关系，要么就是完全一样的，要么就是一个维度在数学意义上是另一个维度的子集。



### 代理键和自然键
1.代理键：代理键是不具有业务含义的键，一般用于处理缓慢变化维，比如时间标签，职称等
2.自然键：具有业务含义的键，与业务耦合，通常是字符型
注：代理键和自然键都是用来标识某维度的具体值，通常在选主键的时候，推荐使用代理键，
1.自然键虽然在逻辑上可以唯一地标识出一条维度信息，但它通常是字符型的，且一般比较长，若用它作为维度表中的主键，那就意味着在事实表中也要加入同样的外键信息，导致事实表列宽过于膨胀而导致性能下降
2.代理键可以作为数据仓库与源系统之间的“缓冲”。随着业务的发展，自然键可能无法很好的与事实表相关联，字段和业务可能会发生改变，选择代理键可以把变化屏蔽在维度表内，不会对事实表产生任何影响

### 事实表
![image](https://user-images.githubusercontent.com/44181286/131645710-fa6be554-ff09-45cb-8ff3-0effdba53965.png)


